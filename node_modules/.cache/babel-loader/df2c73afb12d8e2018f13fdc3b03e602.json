{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect } from 'react';\nimport { setTheme } from '@app/store/slices/themeSlice';\nimport { useAppDispatch, useAppSelector } from '@app/hooks/reduxHooks';\nimport { Dates } from '@app/constants/Dates';\nvar getNextTime = function getNextTime(ms) {\n  var now = Date.now();\n  var clearDate = Dates.getClearDate();\n  var nextTime = clearDate.add(ms, 'ms');\n  var delta = +nextTime - now;\n  return delta < 0 ? delta + 24 * 3600 * 1000 : delta;\n};\nvar timeoutNightStarts = null;\nvar timeoutNightEnds = null;\nexport var useAutoNightMode = function useAutoNightMode() {\n  _s();\n  var dispatch = useAppDispatch();\n  var nightModeState = useAppSelector(function (state) {\n    return state.nightMode;\n  });\n  var isNightMode = nightModeState.isNightMode;\n  var nightTime = nightModeState.nightTime;\n  useEffect(function () {\n    timeoutNightStarts && clearTimeout(timeoutNightStarts);\n    timeoutNightEnds && clearTimeout(timeoutNightEnds);\n    if (isNightMode) {\n      var runTimeoutStart = function runTimeoutStart() {\n        dispatch(setTheme('dark'));\n        timeoutNightStarts = setTimeout(runTimeoutStart, 24 * 3600 * 1000);\n      };\n      var nextStartTime = getNextTime(nightTime[0]);\n      timeoutNightStarts = setTimeout(runTimeoutStart, nextStartTime);\n      var runTimeoutEnd = function runTimeoutEnd() {\n        dispatch(setTheme('light'));\n        timeoutNightEnds = setTimeout(runTimeoutEnd, 24 * 3600 * 1000);\n      };\n      var nextEndTime = getNextTime(nightTime[1]);\n      nextEndTime = nextStartTime > nextEndTime ? nextEndTime + 24 * 3600 * 1000 : nextEndTime;\n      timeoutNightEnds = setTimeout(runTimeoutEnd, nextEndTime);\n    }\n    return function () {\n      timeoutNightStarts && clearTimeout(timeoutNightStarts);\n      timeoutNightEnds && clearTimeout(timeoutNightEnds);\n    };\n  }, [dispatch, isNightMode, nightTime]);\n};\n_s(useAutoNightMode, \"+lWWW8Ujn/wocJ3Vl8RDkhgeQ1U=\", false, function () {\n  return [useAppDispatch, useAppSelector];\n});","map":{"version":3,"names":["useEffect","setTheme","useAppDispatch","useAppSelector","Dates","getNextTime","ms","now","Date","clearDate","getClearDate","nextTime","add","delta","timeoutNightStarts","timeoutNightEnds","useAutoNightMode","dispatch","nightModeState","state","nightMode","isNightMode","nightTime","clearTimeout","runTimeoutStart","setTimeout","nextStartTime","runTimeoutEnd","nextEndTime"],"sources":["/workspace/ant-design-react-template/src/hooks/useAutoNightMode.ts"],"sourcesContent":["import { useEffect } from 'react';\nimport { setTheme } from '@app/store/slices/themeSlice';\nimport { useAppDispatch, useAppSelector } from '@app/hooks/reduxHooks';\nimport { Dates } from '@app/constants/Dates';\n\nconst getNextTime = (ms: number) => {\n  const now = Date.now();\n  const clearDate = Dates.getClearDate();\n  const nextTime = clearDate.add(ms, 'ms');\n\n  const delta = +nextTime - now;\n\n  return delta < 0 ? delta + 24 * 3600 * 1000 : delta;\n};\n\nlet timeoutNightStarts: null | ReturnType<typeof setTimeout> = null;\nlet timeoutNightEnds: null | ReturnType<typeof setTimeout> = null;\n\nexport const useAutoNightMode = (): void => {\n  const dispatch = useAppDispatch();\n  const nightModeState = useAppSelector((state) => state.nightMode);\n  const isNightMode = nightModeState.isNightMode;\n  const nightTime = nightModeState.nightTime;\n\n  useEffect(() => {\n    timeoutNightStarts && clearTimeout(timeoutNightStarts);\n    timeoutNightEnds && clearTimeout(timeoutNightEnds);\n\n    if (isNightMode) {\n      const runTimeoutStart = () => {\n        dispatch(setTheme('dark'));\n        timeoutNightStarts = setTimeout(runTimeoutStart, 24 * 3600 * 1000);\n      };\n\n      const nextStartTime = getNextTime(nightTime[0]);\n      timeoutNightStarts = setTimeout(runTimeoutStart, nextStartTime);\n\n      const runTimeoutEnd = () => {\n        dispatch(setTheme('light'));\n        timeoutNightEnds = setTimeout(runTimeoutEnd, 24 * 3600 * 1000);\n      };\n\n      let nextEndTime = getNextTime(nightTime[1]);\n      nextEndTime = nextStartTime > nextEndTime ? nextEndTime + 24 * 3600 * 1000 : nextEndTime;\n\n      timeoutNightEnds = setTimeout(runTimeoutEnd, nextEndTime);\n    }\n\n    return () => {\n      timeoutNightStarts && clearTimeout(timeoutNightStarts);\n      timeoutNightEnds && clearTimeout(timeoutNightEnds);\n    };\n  }, [dispatch, isNightMode, nightTime]);\n};\n"],"mappings":";AAAA,SAASA,SAAS,QAAQ,OAAO;AACjC,SAASC,QAAQ,QAAQ,8BAA8B;AACvD,SAASC,cAAc,EAAEC,cAAc,QAAQ,uBAAuB;AACtE,SAASC,KAAK,QAAQ,sBAAsB;AAE5C,IAAMC,WAAW,GAAG,SAAdA,WAAW,CAAIC,EAAU,EAAK;EAClC,IAAMC,GAAG,GAAGC,IAAI,CAACD,GAAG,EAAE;EACtB,IAAME,SAAS,GAAGL,KAAK,CAACM,YAAY,EAAE;EACtC,IAAMC,QAAQ,GAAGF,SAAS,CAACG,GAAG,CAACN,EAAE,EAAE,IAAI,CAAC;EAExC,IAAMO,KAAK,GAAG,CAACF,QAAQ,GAAGJ,GAAG;EAE7B,OAAOM,KAAK,GAAG,CAAC,GAAGA,KAAK,GAAG,EAAE,GAAG,IAAI,GAAG,IAAI,GAAGA,KAAK;AACrD,CAAC;AAED,IAAIC,kBAAwD,GAAG,IAAI;AACnE,IAAIC,gBAAsD,GAAG,IAAI;AAEjE,OAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgB,GAAe;EAAA;EAC1C,IAAMC,QAAQ,GAAGf,cAAc,EAAE;EACjC,IAAMgB,cAAc,GAAGf,cAAc,CAAC,UAACgB,KAAK;IAAA,OAAKA,KAAK,CAACC,SAAS;EAAA,EAAC;EACjE,IAAMC,WAAW,GAAGH,cAAc,CAACG,WAAW;EAC9C,IAAMC,SAAS,GAAGJ,cAAc,CAACI,SAAS;EAE1CtB,SAAS,CAAC,YAAM;IACdc,kBAAkB,IAAIS,YAAY,CAACT,kBAAkB,CAAC;IACtDC,gBAAgB,IAAIQ,YAAY,CAACR,gBAAgB,CAAC;IAElD,IAAIM,WAAW,EAAE;MACf,IAAMG,eAAe,GAAG,SAAlBA,eAAe,GAAS;QAC5BP,QAAQ,CAAChB,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC1Ba,kBAAkB,GAAGW,UAAU,CAACD,eAAe,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC;MACpE,CAAC;MAED,IAAME,aAAa,GAAGrB,WAAW,CAACiB,SAAS,CAAC,CAAC,CAAC,CAAC;MAC/CR,kBAAkB,GAAGW,UAAU,CAACD,eAAe,EAAEE,aAAa,CAAC;MAE/D,IAAMC,aAAa,GAAG,SAAhBA,aAAa,GAAS;QAC1BV,QAAQ,CAAChB,QAAQ,CAAC,OAAO,CAAC,CAAC;QAC3Bc,gBAAgB,GAAGU,UAAU,CAACE,aAAa,EAAE,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC;MAChE,CAAC;MAED,IAAIC,WAAW,GAAGvB,WAAW,CAACiB,SAAS,CAAC,CAAC,CAAC,CAAC;MAC3CM,WAAW,GAAGF,aAAa,GAAGE,WAAW,GAAGA,WAAW,GAAG,EAAE,GAAG,IAAI,GAAG,IAAI,GAAGA,WAAW;MAExFb,gBAAgB,GAAGU,UAAU,CAACE,aAAa,EAAEC,WAAW,CAAC;IAC3D;IAEA,OAAO,YAAM;MACXd,kBAAkB,IAAIS,YAAY,CAACT,kBAAkB,CAAC;MACtDC,gBAAgB,IAAIQ,YAAY,CAACR,gBAAgB,CAAC;IACpD,CAAC;EACH,CAAC,EAAE,CAACE,QAAQ,EAAEI,WAAW,EAAEC,SAAS,CAAC,CAAC;AACxC,CAAC;AAAC,GAnCWN,gBAAgB;EAAA,QACVd,cAAc,EACRC,cAAc;AAAA"},"metadata":{},"sourceType":"module"}