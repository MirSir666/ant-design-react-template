{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/ant-design-react-template/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/workspace/ant-design-react-template/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createAsyncThunk,createSlice}from'@reduxjs/toolkit';import{login,signUp,resetPassword,verifySecurityCode,setNewPassword}from'@app/api/auth.api';import{setUser}from'@app/store/slices/userSlice';import{deleteToken,deleteUser,persistToken,readToken}from'@app/services/localStorage.service';var initialState={token:readToken()};export var doLogin=createAsyncThunk('auth/doLogin',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(loginPayload,_ref){var dispatch;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch=_ref.dispatch;return _context.abrupt(\"return\",login(loginPayload).then(function(res){dispatch(setUser(res.user));persistToken(res.token);return res.token;}));case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}());export var doSignUp=createAsyncThunk('auth/doSignUp',/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(signUpPayload){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",signUp(signUpPayload));case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref3.apply(this,arguments);};}());export var doResetPassword=createAsyncThunk('auth/doResetPassword',/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(resetPassPayload){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.abrupt(\"return\",resetPassword(resetPassPayload));case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4){return _ref4.apply(this,arguments);};}());export var doVerifySecurityCode=createAsyncThunk('auth/doVerifySecurityCode',/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(securityCodePayload){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",verifySecurityCode(securityCodePayload));case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x5){return _ref5.apply(this,arguments);};}());export var doSetNewPassword=createAsyncThunk('auth/doSetNewPassword',/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(newPasswordData){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:return _context5.abrupt(\"return\",setNewPassword(newPasswordData));case 1:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x6){return _ref6.apply(this,arguments);};}());export var doLogout=createAsyncThunk('auth/doLogout',function(payload,_ref7){var dispatch=_ref7.dispatch;deleteToken();deleteUser();dispatch(setUser(null));});var authSlice=createSlice({name:'auth',initialState:initialState,reducers:{},extraReducers:function extraReducers(builder){builder.addCase(doLogin.fulfilled,function(state,action){state.token=action.payload;});builder.addCase(doLogout.fulfilled,function(state){state.token='';});}});export default authSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","login","signUp","resetPassword","verifySecurityCode","setNewPassword","setUser","deleteToken","deleteUser","persistToken","readToken","initialState","token","doLogin","loginPayload","dispatch","then","res","user","doSignUp","signUpPayload","doResetPassword","resetPassPayload","doVerifySecurityCode","securityCodePayload","doSetNewPassword","newPasswordData","doLogout","payload","authSlice","name","reducers","extraReducers","builder","addCase","fulfilled","state","action","reducer"],"sources":["/workspace/ant-design-react-template/src/store/slices/authSlice.ts"],"sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport {\n  ResetPasswordRequest,\n  login,\n  LoginRequest,\n  signUp,\n  SignUpRequest,\n  resetPassword,\n  verifySecurityCode,\n  SecurityCodePayload,\n  NewPasswordData,\n  setNewPassword,\n} from '@app/api/auth.api';\nimport { setUser } from '@app/store/slices/userSlice';\nimport { deleteToken, deleteUser, persistToken, readToken } from '@app/services/localStorage.service';\n\nexport interface AuthSlice {\n  token: string | null;\n}\n\nconst initialState: AuthSlice = {\n  token: readToken(),\n};\n\nexport const doLogin = createAsyncThunk('auth/doLogin', async (loginPayload: LoginRequest, { dispatch }) =>\n  login(loginPayload).then((res) => {\n    dispatch(setUser(res.user));\n    persistToken(res.token);\n\n    return res.token;\n  }),\n);\n\nexport const doSignUp = createAsyncThunk('auth/doSignUp', async (signUpPayload: SignUpRequest) =>\n  signUp(signUpPayload),\n);\n\nexport const doResetPassword = createAsyncThunk(\n  'auth/doResetPassword',\n  async (resetPassPayload: ResetPasswordRequest) => resetPassword(resetPassPayload),\n);\n\nexport const doVerifySecurityCode = createAsyncThunk(\n  'auth/doVerifySecurityCode',\n  async (securityCodePayload: SecurityCodePayload) => verifySecurityCode(securityCodePayload),\n);\n\nexport const doSetNewPassword = createAsyncThunk('auth/doSetNewPassword', async (newPasswordData: NewPasswordData) =>\n  setNewPassword(newPasswordData),\n);\n\nexport const doLogout = createAsyncThunk('auth/doLogout', (payload, { dispatch }) => {\n  deleteToken();\n  deleteUser();\n  dispatch(setUser(null));\n});\n\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(doLogin.fulfilled, (state, action) => {\n      state.token = action.payload;\n    });\n    builder.addCase(doLogout.fulfilled, (state) => {\n      state.token = '';\n    });\n  },\n});\n\nexport default authSlice.reducer;\n"],"mappings":"oQAAA,OAASA,gBAAgB,CAAEC,WAAW,KAAQ,kBAAkB,CAChE,OAEEC,KAAK,CAELC,MAAM,CAENC,aAAa,CACbC,kBAAkB,CAGlBC,cAAc,KACT,mBAAmB,CAC1B,OAASC,OAAO,KAAQ,6BAA6B,CACrD,OAASC,WAAW,CAAEC,UAAU,CAAEC,YAAY,CAAEC,SAAS,KAAQ,oCAAoC,CAMrG,GAAMC,aAAuB,CAAG,CAC9BC,KAAK,CAAEF,SAAS,EAClB,CAAC,CAED,MAAO,IAAMG,QAAO,CAAGd,gBAAgB,CAAC,cAAc,6FAAE,iBAAOe,YAA0B,sIAAIC,QAAQ,MAARA,QAAQ,iCACnGd,KAAK,CAACa,YAAY,CAAC,CAACE,IAAI,CAAC,SAACC,GAAG,CAAK,CAChCF,QAAQ,CAACT,OAAO,CAACW,GAAG,CAACC,IAAI,CAAC,CAAC,CAC3BT,YAAY,CAACQ,GAAG,CAACL,KAAK,CAAC,CAEvB,MAAOK,IAAG,CAACL,KAAK,CAClB,CAAC,CAAC,4HACH,CAED,MAAO,IAAMO,SAAQ,CAAGpB,gBAAgB,CAAC,eAAe,6FAAE,kBAAOqB,aAA4B,yJAC3FlB,MAAM,CAACkB,aAAa,CAAC,2HACtB,CAED,MAAO,IAAMC,gBAAe,CAAGtB,gBAAgB,CAC7C,sBAAsB,6FACtB,kBAAOuB,gBAAsC,yJAAKnB,aAAa,CAACmB,gBAAgB,CAAC,2HAClF,CAED,MAAO,IAAMC,qBAAoB,CAAGxB,gBAAgB,CAClD,2BAA2B,6FAC3B,kBAAOyB,mBAAwC,yJAAKpB,kBAAkB,CAACoB,mBAAmB,CAAC,2HAC5F,CAED,MAAO,IAAMC,iBAAgB,CAAG1B,gBAAgB,CAAC,uBAAuB,6FAAE,kBAAO2B,eAAgC,yJAC/GrB,cAAc,CAACqB,eAAe,CAAC,2HAChC,CAED,MAAO,IAAMC,SAAQ,CAAG5B,gBAAgB,CAAC,eAAe,CAAE,SAAC6B,OAAO,OAAmB,IAAfb,SAAQ,OAARA,QAAQ,CAC5ER,WAAW,EAAE,CACbC,UAAU,EAAE,CACZO,QAAQ,CAACT,OAAO,CAAC,IAAI,CAAC,CAAC,CACzB,CAAC,CAAC,CAEF,GAAMuB,UAAS,CAAG7B,WAAW,CAAC,CAC5B8B,IAAI,CAAE,MAAM,CACZnB,YAAY,CAAZA,YAAY,CACZoB,QAAQ,CAAE,CAAC,CAAC,CACZC,aAAa,CAAE,uBAACC,OAAO,CAAK,CAC1BA,OAAO,CAACC,OAAO,CAACrB,OAAO,CAACsB,SAAS,CAAE,SAACC,KAAK,CAAEC,MAAM,CAAK,CACpDD,KAAK,CAACxB,KAAK,CAAGyB,MAAM,CAACT,OAAO,CAC9B,CAAC,CAAC,CACFK,OAAO,CAACC,OAAO,CAACP,QAAQ,CAACQ,SAAS,CAAE,SAACC,KAAK,CAAK,CAC7CA,KAAK,CAACxB,KAAK,CAAG,EAAE,CAClB,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CAEF,cAAeiB,UAAS,CAACS,OAAO"},"metadata":{},"sourceType":"module"}