{"ast":null,"code":"import _objectSpread from\"/workspace/ant-design-react-template/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/workspace/ant-design-react-template/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useCallback}from'react';import{Table}from'components/common/Table/Table';import{getTreeTableData}from'api/table.api';import{useTranslation}from'react-i18next';import{useMounted}from'@app/hooks/useMounted';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var initialPagination={current:1,pageSize:4};export var TreeTable=function TreeTable(){var _useState=useState({data:[],pagination:initialPagination,loading:false}),_useState2=_slicedToArray(_useState,2),tableData=_useState2[0],setTableData=_useState2[1];var _useTranslation=useTranslation(),t=_useTranslation.t;var _useMounted=useMounted(),isMounted=_useMounted.isMounted;var fetch=useCallback(function(pagination){setTableData(function(tableData){return _objectSpread(_objectSpread({},tableData),{},{loading:true});});getTreeTableData(pagination).then(function(res){if(isMounted.current){setTableData({data:res.data,pagination:res.pagination,loading:false});}});},[isMounted]);useEffect(function(){fetch(initialPagination);},[fetch]);var handleTableChange=function handleTableChange(pagination){fetch(pagination);};var rowSelection={onChange:function onChange(selectedRowKeys,selectedRows){console.log(selectedRowKeys,selectedRows);},onSelect:function onSelect(record,selected,selectedRows){console.log(record,selected,selectedRows);},onSelectAll:function onSelectAll(selected,selectedRows){console.log(selected,selectedRows);}};var columns=[{title:t('common.name'),dataIndex:'name',key:'name'},{title:t('common.age'),dataIndex:'age',key:'age',width:'12%'},{title:t('common.address'),dataIndex:'address',width:'30%',key:'address'}];return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Table,{columns:columns,dataSource:tableData.data,rowSelection:_objectSpread({},rowSelection),pagination:tableData.pagination,loading:tableData.loading,onChange:handleTableChange,scroll:{x:800}})});};","map":{"version":3,"names":["React","useState","useEffect","useCallback","Table","getTreeTableData","useTranslation","useMounted","initialPagination","current","pageSize","TreeTable","data","pagination","loading","tableData","setTableData","t","isMounted","fetch","then","res","handleTableChange","rowSelection","onChange","selectedRowKeys","selectedRows","console","log","onSelect","record","selected","onSelectAll","columns","title","dataIndex","key","width","x"],"sources":["/workspace/ant-design-react-template/src/components/tables/TreeTable/TreeTable.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { Table } from 'components/common/Table/Table';\nimport { TablePaginationConfig } from 'antd';\nimport { Key, DefaultRecordType } from 'rc-table/lib/interface';\nimport { TreeTableRow, Pagination, getTreeTableData } from 'api/table.api';\nimport { useTranslation } from 'react-i18next';\nimport { useMounted } from '@app/hooks/useMounted';\n\nconst initialPagination: Pagination = {\n  current: 1,\n  pageSize: 4,\n};\n\nexport const TreeTable: React.FC = () => {\n  const [tableData, setTableData] = useState<{ data: TreeTableRow[]; pagination: Pagination; loading: boolean }>({\n    data: [],\n    pagination: initialPagination,\n    loading: false,\n  });\n  const { t } = useTranslation();\n  const { isMounted } = useMounted();\n\n  const fetch = useCallback(\n    (pagination: Pagination) => {\n      setTableData((tableData) => ({ ...tableData, loading: true }));\n      getTreeTableData(pagination).then((res) => {\n        if (isMounted.current) {\n          setTableData({ data: res.data, pagination: res.pagination, loading: false });\n        }\n      });\n    },\n    [isMounted],\n  );\n\n  useEffect(() => {\n    fetch(initialPagination);\n  }, [fetch]);\n\n  const handleTableChange = (pagination: TablePaginationConfig) => {\n    fetch(pagination);\n  };\n\n  const rowSelection = {\n    onChange: (selectedRowKeys: Key[], selectedRows: DefaultRecordType[]) => {\n      console.log(selectedRowKeys, selectedRows);\n    },\n    onSelect: (record: DefaultRecordType, selected: boolean, selectedRows: DefaultRecordType[]) => {\n      console.log(record, selected, selectedRows);\n    },\n    onSelectAll: (selected: boolean, selectedRows: DefaultRecordType[]) => {\n      console.log(selected, selectedRows);\n    },\n  };\n\n  const columns = [\n    {\n      title: t('common.name'),\n      dataIndex: 'name',\n      key: 'name',\n    },\n    {\n      title: t('common.age'),\n      dataIndex: 'age',\n      key: 'age',\n      width: '12%',\n    },\n    {\n      title: t('common.address'),\n      dataIndex: 'address',\n      width: '30%',\n      key: 'address',\n    },\n  ];\n\n  return (\n    <>\n      <Table\n        columns={columns}\n        dataSource={tableData.data}\n        rowSelection={{ ...rowSelection }}\n        pagination={tableData.pagination}\n        loading={tableData.loading}\n        onChange={handleTableChange}\n        scroll={{ x: 800 }}\n      />\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}