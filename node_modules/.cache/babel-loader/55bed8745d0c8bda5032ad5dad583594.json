{"ast":null,"code":"import{useEffect}from'react';import{setTheme}from'@app/store/slices/themeSlice';import{useAppDispatch,useAppSelector}from'@app/hooks/reduxHooks';import{Dates}from'@app/constants/Dates';var getNextTime=function getNextTime(ms){var now=Date.now();var clearDate=Dates.getClearDate();var nextTime=clearDate.add(ms,'ms');var delta=+nextTime-now;return delta<0?delta+24*3600*1000:delta;};var timeoutNightStarts=null;var timeoutNightEnds=null;export var useAutoNightMode=function useAutoNightMode(){var dispatch=useAppDispatch();var nightModeState=useAppSelector(function(state){return state.nightMode;});var isNightMode=nightModeState.isNightMode;var nightTime=nightModeState.nightTime;useEffect(function(){timeoutNightStarts&&clearTimeout(timeoutNightStarts);timeoutNightEnds&&clearTimeout(timeoutNightEnds);if(isNightMode){var runTimeoutStart=function runTimeoutStart(){dispatch(setTheme('dark'));timeoutNightStarts=setTimeout(runTimeoutStart,24*3600*1000);};var nextStartTime=getNextTime(nightTime[0]);timeoutNightStarts=setTimeout(runTimeoutStart,nextStartTime);var runTimeoutEnd=function runTimeoutEnd(){dispatch(setTheme('light'));timeoutNightEnds=setTimeout(runTimeoutEnd,24*3600*1000);};var nextEndTime=getNextTime(nightTime[1]);nextEndTime=nextStartTime>nextEndTime?nextEndTime+24*3600*1000:nextEndTime;timeoutNightEnds=setTimeout(runTimeoutEnd,nextEndTime);}return function(){timeoutNightStarts&&clearTimeout(timeoutNightStarts);timeoutNightEnds&&clearTimeout(timeoutNightEnds);};},[dispatch,isNightMode,nightTime]);};","map":{"version":3,"names":["useEffect","setTheme","useAppDispatch","useAppSelector","Dates","getNextTime","ms","now","Date","clearDate","getClearDate","nextTime","add","delta","timeoutNightStarts","timeoutNightEnds","useAutoNightMode","dispatch","nightModeState","state","nightMode","isNightMode","nightTime","clearTimeout","runTimeoutStart","setTimeout","nextStartTime","runTimeoutEnd","nextEndTime"],"sources":["/workspace/ant-design-react-template/src/hooks/useAutoNightMode.ts"],"sourcesContent":["import { useEffect } from 'react';\nimport { setTheme } from '@app/store/slices/themeSlice';\nimport { useAppDispatch, useAppSelector } from '@app/hooks/reduxHooks';\nimport { Dates } from '@app/constants/Dates';\n\nconst getNextTime = (ms: number) => {\n  const now = Date.now();\n  const clearDate = Dates.getClearDate();\n  const nextTime = clearDate.add(ms, 'ms');\n\n  const delta = +nextTime - now;\n\n  return delta < 0 ? delta + 24 * 3600 * 1000 : delta;\n};\n\nlet timeoutNightStarts: null | ReturnType<typeof setTimeout> = null;\nlet timeoutNightEnds: null | ReturnType<typeof setTimeout> = null;\n\nexport const useAutoNightMode = (): void => {\n  const dispatch = useAppDispatch();\n  const nightModeState = useAppSelector((state) => state.nightMode);\n  const isNightMode = nightModeState.isNightMode;\n  const nightTime = nightModeState.nightTime;\n\n  useEffect(() => {\n    timeoutNightStarts && clearTimeout(timeoutNightStarts);\n    timeoutNightEnds && clearTimeout(timeoutNightEnds);\n\n    if (isNightMode) {\n      const runTimeoutStart = () => {\n        dispatch(setTheme('dark'));\n        timeoutNightStarts = setTimeout(runTimeoutStart, 24 * 3600 * 1000);\n      };\n\n      const nextStartTime = getNextTime(nightTime[0]);\n      timeoutNightStarts = setTimeout(runTimeoutStart, nextStartTime);\n\n      const runTimeoutEnd = () => {\n        dispatch(setTheme('light'));\n        timeoutNightEnds = setTimeout(runTimeoutEnd, 24 * 3600 * 1000);\n      };\n\n      let nextEndTime = getNextTime(nightTime[1]);\n      nextEndTime = nextStartTime > nextEndTime ? nextEndTime + 24 * 3600 * 1000 : nextEndTime;\n\n      timeoutNightEnds = setTimeout(runTimeoutEnd, nextEndTime);\n    }\n\n    return () => {\n      timeoutNightStarts && clearTimeout(timeoutNightStarts);\n      timeoutNightEnds && clearTimeout(timeoutNightEnds);\n    };\n  }, [dispatch, isNightMode, nightTime]);\n};\n"],"mappings":"AAAA,OAASA,SAAS,KAAQ,OAAO,CACjC,OAASC,QAAQ,KAAQ,8BAA8B,CACvD,OAASC,cAAc,CAAEC,cAAc,KAAQ,uBAAuB,CACtE,OAASC,KAAK,KAAQ,sBAAsB,CAE5C,GAAMC,YAAW,CAAG,QAAdA,YAAW,CAAIC,EAAU,CAAK,CAClC,GAAMC,IAAG,CAAGC,IAAI,CAACD,GAAG,EAAE,CACtB,GAAME,UAAS,CAAGL,KAAK,CAACM,YAAY,EAAE,CACtC,GAAMC,SAAQ,CAAGF,SAAS,CAACG,GAAG,CAACN,EAAE,CAAE,IAAI,CAAC,CAExC,GAAMO,MAAK,CAAG,CAACF,QAAQ,CAAGJ,GAAG,CAE7B,MAAOM,MAAK,CAAG,CAAC,CAAGA,KAAK,CAAG,EAAE,CAAG,IAAI,CAAG,IAAI,CAAGA,KAAK,CACrD,CAAC,CAED,GAAIC,mBAAwD,CAAG,IAAI,CACnE,GAAIC,iBAAsD,CAAG,IAAI,CAEjE,MAAO,IAAMC,iBAAgB,CAAG,QAAnBA,iBAAgB,EAAe,CAC1C,GAAMC,SAAQ,CAAGf,cAAc,EAAE,CACjC,GAAMgB,eAAc,CAAGf,cAAc,CAAC,SAACgB,KAAK,QAAKA,MAAK,CAACC,SAAS,GAAC,CACjE,GAAMC,YAAW,CAAGH,cAAc,CAACG,WAAW,CAC9C,GAAMC,UAAS,CAAGJ,cAAc,CAACI,SAAS,CAE1CtB,SAAS,CAAC,UAAM,CACdc,kBAAkB,EAAIS,YAAY,CAACT,kBAAkB,CAAC,CACtDC,gBAAgB,EAAIQ,YAAY,CAACR,gBAAgB,CAAC,CAElD,GAAIM,WAAW,CAAE,CACf,GAAMG,gBAAe,CAAG,QAAlBA,gBAAe,EAAS,CAC5BP,QAAQ,CAAChB,QAAQ,CAAC,MAAM,CAAC,CAAC,CAC1Ba,kBAAkB,CAAGW,UAAU,CAACD,eAAe,CAAE,EAAE,CAAG,IAAI,CAAG,IAAI,CAAC,CACpE,CAAC,CAED,GAAME,cAAa,CAAGrB,WAAW,CAACiB,SAAS,CAAC,CAAC,CAAC,CAAC,CAC/CR,kBAAkB,CAAGW,UAAU,CAACD,eAAe,CAAEE,aAAa,CAAC,CAE/D,GAAMC,cAAa,CAAG,QAAhBA,cAAa,EAAS,CAC1BV,QAAQ,CAAChB,QAAQ,CAAC,OAAO,CAAC,CAAC,CAC3Bc,gBAAgB,CAAGU,UAAU,CAACE,aAAa,CAAE,EAAE,CAAG,IAAI,CAAG,IAAI,CAAC,CAChE,CAAC,CAED,GAAIC,YAAW,CAAGvB,WAAW,CAACiB,SAAS,CAAC,CAAC,CAAC,CAAC,CAC3CM,WAAW,CAAGF,aAAa,CAAGE,WAAW,CAAGA,WAAW,CAAG,EAAE,CAAG,IAAI,CAAG,IAAI,CAAGA,WAAW,CAExFb,gBAAgB,CAAGU,UAAU,CAACE,aAAa,CAAEC,WAAW,CAAC,CAC3D,CAEA,MAAO,WAAM,CACXd,kBAAkB,EAAIS,YAAY,CAACT,kBAAkB,CAAC,CACtDC,gBAAgB,EAAIQ,YAAY,CAACR,gBAAgB,CAAC,CACpD,CAAC,CACH,CAAC,CAAE,CAACE,QAAQ,CAAEI,WAAW,CAAEC,SAAS,CAAC,CAAC,CACxC,CAAC"},"metadata":{},"sourceType":"module"}