{"ast":null,"code":"import _regeneratorRuntime from \"/workspace/ant-design-react-template/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/workspace/ant-design-react-template/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport { login, signUp, resetPassword, verifySecurityCode, setNewPassword } from '@app/api/auth.api';\nimport { setUser } from '@app/store/slices/userSlice';\nimport { deleteToken, deleteUser, persistToken, readToken } from '@app/services/localStorage.service';\nvar initialState = {\n  token: readToken()\n};\nexport var doLogin = createAsyncThunk('auth/doLogin', /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(loginPayload, _ref) {\n    var dispatch;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            dispatch = _ref.dispatch;\n            return _context.abrupt(\"return\", login(loginPayload).then(function (res) {\n              dispatch(setUser(res.user));\n              persistToken(res.token);\n              return res.token;\n            }));\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return function (_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nexport var doSignUp = createAsyncThunk('auth/doSignUp', /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(signUpPayload) {\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            return _context2.abrupt(\"return\", signUp(signUpPayload));\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return function (_x3) {\n    return _ref3.apply(this, arguments);\n  };\n}());\nexport var doResetPassword = createAsyncThunk('auth/doResetPassword', /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(resetPassPayload) {\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            return _context3.abrupt(\"return\", resetPassword(resetPassPayload));\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return function (_x4) {\n    return _ref4.apply(this, arguments);\n  };\n}());\nexport var doVerifySecurityCode = createAsyncThunk('auth/doVerifySecurityCode', /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(securityCodePayload) {\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            return _context4.abrupt(\"return\", verifySecurityCode(securityCodePayload));\n          case 1:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return function (_x5) {\n    return _ref5.apply(this, arguments);\n  };\n}());\nexport var doSetNewPassword = createAsyncThunk('auth/doSetNewPassword', /*#__PURE__*/function () {\n  var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(newPasswordData) {\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            return _context5.abrupt(\"return\", setNewPassword(newPasswordData));\n          case 1:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n  return function (_x6) {\n    return _ref6.apply(this, arguments);\n  };\n}());\nexport var doLogout = createAsyncThunk('auth/doLogout', function (payload, _ref7) {\n  var dispatch = _ref7.dispatch;\n  deleteToken();\n  deleteUser();\n  dispatch(setUser(null));\n});\nvar authSlice = createSlice({\n  name: 'auth',\n  initialState: initialState,\n  reducers: {},\n  extraReducers: function extraReducers(builder) {\n    builder.addCase(doLogin.fulfilled, function (state, action) {\n      state.token = action.payload;\n    });\n    builder.addCase(doLogout.fulfilled, function (state) {\n      state.token = '';\n    });\n  }\n});\nexport default authSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","login","signUp","resetPassword","verifySecurityCode","setNewPassword","setUser","deleteToken","deleteUser","persistToken","readToken","initialState","token","doLogin","loginPayload","dispatch","then","res","user","doSignUp","signUpPayload","doResetPassword","resetPassPayload","doVerifySecurityCode","securityCodePayload","doSetNewPassword","newPasswordData","doLogout","payload","authSlice","name","reducers","extraReducers","builder","addCase","fulfilled","state","action","reducer"],"sources":["/workspace/ant-design-react-template/src/store/slices/authSlice.ts"],"sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport {\n  ResetPasswordRequest,\n  login,\n  LoginRequest,\n  signUp,\n  SignUpRequest,\n  resetPassword,\n  verifySecurityCode,\n  SecurityCodePayload,\n  NewPasswordData,\n  setNewPassword,\n} from '@app/api/auth.api';\nimport { setUser } from '@app/store/slices/userSlice';\nimport { deleteToken, deleteUser, persistToken, readToken } from '@app/services/localStorage.service';\n\nexport interface AuthSlice {\n  token: string | null;\n}\n\nconst initialState: AuthSlice = {\n  token: readToken(),\n};\n\nexport const doLogin = createAsyncThunk('auth/doLogin', async (loginPayload: LoginRequest, { dispatch }) =>\n  login(loginPayload).then((res) => {\n    dispatch(setUser(res.user));\n    persistToken(res.token);\n\n    return res.token;\n  }),\n);\n\nexport const doSignUp = createAsyncThunk('auth/doSignUp', async (signUpPayload: SignUpRequest) =>\n  signUp(signUpPayload),\n);\n\nexport const doResetPassword = createAsyncThunk(\n  'auth/doResetPassword',\n  async (resetPassPayload: ResetPasswordRequest) => resetPassword(resetPassPayload),\n);\n\nexport const doVerifySecurityCode = createAsyncThunk(\n  'auth/doVerifySecurityCode',\n  async (securityCodePayload: SecurityCodePayload) => verifySecurityCode(securityCodePayload),\n);\n\nexport const doSetNewPassword = createAsyncThunk('auth/doSetNewPassword', async (newPasswordData: NewPasswordData) =>\n  setNewPassword(newPasswordData),\n);\n\nexport const doLogout = createAsyncThunk('auth/doLogout', (payload, { dispatch }) => {\n  deleteToken();\n  deleteUser();\n  dispatch(setUser(null));\n});\n\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(doLogin.fulfilled, (state, action) => {\n      state.token = action.payload;\n    });\n    builder.addCase(doLogout.fulfilled, (state) => {\n      state.token = '';\n    });\n  },\n});\n\nexport default authSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}