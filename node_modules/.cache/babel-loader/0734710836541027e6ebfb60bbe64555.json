{"ast":null,"code":"import _objectSpread from\"/workspace/ant-design-react-template/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/workspace/ant-design-react-template/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{Col,Row}from'antd';import{useTranslation}from'react-i18next';import{PlusOutlined}from'@ant-design/icons';import{BaseButtonsForm}from'@app/components/common/forms/BaseButtonsForm/BaseButtonsForm';import{Input}from'@app/components/common/inputs/Input/Input';import{Select,Option}from'@app/components/common/selects/Select/Select';import{Button}from'@app/components/common/buttons/Button/Button';import{notificationController}from'@app/controllers/notificationController';import*as S from'./DynamicForm.styles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var DynamicForm=function DynamicForm(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isFieldsChanged=_useState2[0],setFieldsChanged=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setLoading=_useState4[1];var _BaseButtonsForm$useF=BaseButtonsForm.useForm(),_BaseButtonsForm$useF2=_slicedToArray(_BaseButtonsForm$useF,1),form=_BaseButtonsForm$useF2[0];var _useTranslation=useTranslation(),t=_useTranslation.t;var areas=[{label:t('forms.dynamicFormLabels.beijing'),value:'Beijing'},{label:t('forms.dynamicFormLabels.shanghai'),value:'Shanghai'}];var sights={Beijing:[t('forms.dynamicFormLabels.tiananmen'),t('forms.dynamicFormLabels.greatWall')],Shanghai:[t('forms.dynamicFormLabels.orientalPearl'),t('forms.dynamicFormLabels.theBund')]};var onFinish=function onFinish(){var values=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};setLoading(true);setTimeout(function(){setLoading(false);setFieldsChanged(false);notificationController.success({message:t('common.success')});console.log(values);},1000);};var handleChange=function handleChange(){form.setFieldsValue({sights:[]});};return/*#__PURE__*/_jsxs(BaseButtonsForm,{form:form,name:\"dynamicForm\",isFieldsChanged:isFieldsChanged,loading:isLoading,onFinish:onFinish,autoComplete:\"off\",onFieldsChange:function onFieldsChange(){return setFieldsChanged(true);},children:[/*#__PURE__*/_jsx(BaseButtonsForm.Item,{name:\"area\",label:t('forms.dynamicFormLabels.area'),rules:[{required:true,message:t('forms.dynamicFormLabels.areaError')}],children:/*#__PURE__*/_jsx(Select,{options:areas,onChange:handleChange})}),/*#__PURE__*/_jsx(BaseButtonsForm.List,{name:\"sights\",children:function children(fields,_ref){var add=_ref.add,remove=_ref.remove;return/*#__PURE__*/_jsxs(_Fragment,{children:[fields.map(function(field){return/*#__PURE__*/_jsxs(Row,{wrap:false,gutter:[10,10],align:\"middle\",justify:\"space-between\",children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(BaseButtonsForm.Item,{noStyle:true// eslint-disable-next-line\n,shouldUpdate:function shouldUpdate(prevValues,curValues){return prevValues.area!==curValues.area||prevValues.sights!==curValues.sights;},children:function children(){return/*#__PURE__*/_jsx(BaseButtonsForm.Item,_objectSpread(_objectSpread({},field),{},{label:t('forms.dynamicFormLabels.sight'),name:[field.name,'sight'],fieldKey:[field.key,'sight'],rules:[{required:true,message:t('forms.dynamicFormLabels.sightError')}],children:/*#__PURE__*/_jsx(Select,{disabled:!form.getFieldValue('area'),children:(sights[form.getFieldValue('area')]||[]).map(function(item){return/*#__PURE__*/_jsx(Option,{value:item,children:item},item);})})}));}})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(BaseButtonsForm.Item,_objectSpread(_objectSpread({},field),{},{label:t('forms.dynamicFormLabels.price'),name:[field.name,'price'],fieldKey:[field.key,'price'],rules:[{required:true,message:t('forms.dynamicFormLabels.priceError')}],children:/*#__PURE__*/_jsxs(S.Wrapper,{children:[/*#__PURE__*/_jsx(Input,{}),/*#__PURE__*/_jsx(S.RemoveBtn,{onClick:function onClick(){return remove(field.name);}})]})}))})]},field.key);}),/*#__PURE__*/_jsx(BaseButtonsForm.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"dashed\",onClick:function onClick(){return add();},block:true,icon:/*#__PURE__*/_jsx(PlusOutlined,{}),children:t('forms.dynamicFormLabels.addSights')})})]});}})]});};","map":{"version":3,"names":["React","useState","Col","Row","useTranslation","PlusOutlined","BaseButtonsForm","Input","Select","Option","Button","notificationController","S","DynamicForm","isFieldsChanged","setFieldsChanged","isLoading","setLoading","useForm","form","t","areas","label","value","sights","Beijing","Shanghai","onFinish","values","setTimeout","success","message","console","log","handleChange","setFieldsValue","required","fields","add","remove","map","field","prevValues","curValues","area","name","key","getFieldValue","item"],"sources":["/workspace/ant-design-react-template/src/components/forms/DynamicForm/DynamicForm.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Col, Row } from 'antd';\nimport { useTranslation } from 'react-i18next';\nimport { PlusOutlined } from '@ant-design/icons';\nimport { BaseButtonsForm } from '@app/components/common/forms/BaseButtonsForm/BaseButtonsForm';\nimport { Input } from '@app/components/common/inputs/Input/Input';\nimport { Select, Option } from '@app/components/common/selects/Select/Select';\nimport { Button } from '@app/components/common/buttons/Button/Button';\nimport { notificationController } from '@app/controllers/notificationController';\nimport * as S from './DynamicForm.styles';\n\ninterface Sight {\n  [key: string]: string[];\n}\n\nexport const DynamicForm: React.FC = () => {\n  const [isFieldsChanged, setFieldsChanged] = useState(false);\n  const [isLoading, setLoading] = useState(false);\n  const [form] = BaseButtonsForm.useForm();\n  const { t } = useTranslation();\n\n  const areas = [\n    { label: t('forms.dynamicFormLabels.beijing'), value: 'Beijing' },\n    { label: t('forms.dynamicFormLabels.shanghai'), value: 'Shanghai' },\n  ];\n\n  const sights: Sight = {\n    Beijing: [t('forms.dynamicFormLabels.tiananmen'), t('forms.dynamicFormLabels.greatWall')],\n    Shanghai: [t('forms.dynamicFormLabels.orientalPearl'), t('forms.dynamicFormLabels.theBund')],\n  };\n\n  const onFinish = (values = {}) => {\n    setLoading(true);\n    setTimeout(() => {\n      setLoading(false);\n      setFieldsChanged(false);\n      notificationController.success({ message: t('common.success') });\n      console.log(values);\n    }, 1000);\n  };\n\n  const handleChange = () => {\n    form.setFieldsValue({ sights: [] });\n  };\n\n  return (\n    <BaseButtonsForm\n      form={form}\n      name=\"dynamicForm\"\n      isFieldsChanged={isFieldsChanged}\n      loading={isLoading}\n      onFinish={onFinish}\n      autoComplete=\"off\"\n      onFieldsChange={() => setFieldsChanged(true)}\n    >\n      <BaseButtonsForm.Item\n        name=\"area\"\n        label={t('forms.dynamicFormLabels.area')}\n        rules={[{ required: true, message: t('forms.dynamicFormLabels.areaError') }]}\n      >\n        <Select options={areas} onChange={handleChange} />\n      </BaseButtonsForm.Item>\n      <BaseButtonsForm.List name=\"sights\">\n        {(fields, { add, remove }) => (\n          <>\n            {fields.map((field) => (\n              <Row key={field.key} wrap={false} gutter={[10, 10]} align=\"middle\" justify=\"space-between\">\n                <Col span={12}>\n                  <BaseButtonsForm.Item\n                    noStyle\n                    // eslint-disable-next-line\n                    shouldUpdate={(prevValues: any, curValues: any) =>\n                      prevValues.area !== curValues.area || prevValues.sights !== curValues.sights\n                    }\n                  >\n                    {() => (\n                      <BaseButtonsForm.Item\n                        {...field}\n                        label={t('forms.dynamicFormLabels.sight')}\n                        name={[field.name, 'sight']}\n                        fieldKey={[field.key, 'sight']}\n                        rules={[{ required: true, message: t('forms.dynamicFormLabels.sightError') }]}\n                      >\n                        <Select disabled={!form.getFieldValue('area')}>\n                          {(sights[form.getFieldValue('area')] || []).map((item) => (\n                            <Option key={item} value={item}>\n                              {item}\n                            </Option>\n                          ))}\n                        </Select>\n                      </BaseButtonsForm.Item>\n                    )}\n                  </BaseButtonsForm.Item>\n                </Col>\n                <Col span={12}>\n                  <BaseButtonsForm.Item\n                    {...field}\n                    label={t('forms.dynamicFormLabels.price')}\n                    name={[field.name, 'price']}\n                    fieldKey={[field.key, 'price']}\n                    rules={[{ required: true, message: t('forms.dynamicFormLabels.priceError') }]}\n                  >\n                    <S.Wrapper>\n                      <Input />\n                      <S.RemoveBtn onClick={() => remove(field.name)} />\n                    </S.Wrapper>\n                  </BaseButtonsForm.Item>\n                </Col>\n              </Row>\n            ))}\n\n            <BaseButtonsForm.Item>\n              <Button type=\"dashed\" onClick={() => add()} block icon={<PlusOutlined />}>\n                {t('forms.dynamicFormLabels.addSights')}\n              </Button>\n            </BaseButtonsForm.Item>\n          </>\n        )}\n      </BaseButtonsForm.List>\n    </BaseButtonsForm>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}