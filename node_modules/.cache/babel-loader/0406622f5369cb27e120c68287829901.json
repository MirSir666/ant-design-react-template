{"ast":null,"code":"import _defineProperty from \"/workspace/lightence-ant-design-react-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _toConsumableArray from \"/workspace/lightence-ant-design-react-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _objectSpread from \"/workspace/lightence-ant-design-react-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _slicedToArray from \"/workspace/lightence-ant-design-react-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/workspace/lightence-ant-design-react-template/src/components/apps/newsFeed/NewsFilter/NewsFilter.tsx\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Tag } from '@app/components/common/Tag/Tag';\nimport { AuthorValidator, TitleValidator, DatesValidator, TagsValidator } from '../Validator';\nimport { useResponsive } from '@app/hooks/useResponsive';\nimport { newsTags as defaultTags } from '@app/constants/newsTags';\nimport { Dates } from '@app/constants/Dates';\nimport * as S from './NewsFilter.styles';\nimport { Dropdown } from '@app/components/common/Dropdown/Dropdown';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar Filter = function Filter(_ref) {\n  _s();\n\n  var author = _ref.author,\n      title = _ref.title,\n      newsTagData = _ref.newsTagData,\n      onTagClick = _ref.onTagClick,\n      selectedTagsIds = _ref.selectedTagsIds,\n      selectedTags = _ref.selectedTags,\n      dates = _ref.dates,\n      onApply = _ref.onApply,\n      onReset = _ref.onReset,\n      updateFilteredField = _ref.updateFilteredField;\n\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t;\n\n  var _useResponsive = useResponsive(),\n      mobileOnly = _useResponsive.mobileOnly;\n\n  var applyFilter = function applyFilter() {\n    onApply();\n  };\n\n  var resetFilter = function resetFilter() {\n    onReset();\n  };\n\n  return /*#__PURE__*/_jsxDEV(S.FilterWrapper, {\n    children: [!mobileOnly && /*#__PURE__*/_jsxDEV(S.FilterTitle, {\n      children: t('newsFeed.filter')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 23\n    }, _this), /*#__PURE__*/_jsxDEV(S.InputWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(S.SearchIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(S.Input, {\n        placeholder: t('newsFeed.authorSearch'),\n        value: author,\n        onChange: function onChange(event) {\n          return updateFilteredField('author', event.target.value);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.InputWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(S.SearchIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(S.Input, {\n        placeholder: t('newsFeed.titleSearch'),\n        value: title,\n        onChange: function onChange(event) {\n          return updateFilteredField('title', event.target.value);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Dropdown, {\n      placement: \"bottomCenter\",\n      trigger: ['click'],\n      overlay: /*#__PURE__*/_jsxDEV(S.TagPopover, {\n        children: [newsTagData.map(function (tag) {\n          return /*#__PURE__*/_jsxDEV(S.TagPopoverLine, {\n            onClick: function onClick(e) {\n              onTagClick(tag);\n              e.stopPropagation();\n            },\n            children: [/*#__PURE__*/_jsxDEV(S.PopoverCheckbox, {\n              checked: selectedTagsIds.includes(tag.id)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(Tag, {\n              title: tag.title,\n              bgColor: tag.bgColor\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 17\n            }, _this)]\n          }, tag.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 15\n          }, _this);\n        }), /*#__PURE__*/_jsxDEV(S.ClosePopoverWrapper, {\n          children: /*#__PURE__*/_jsxDEV(S.ClosePopover, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, _this),\n      children: /*#__PURE__*/_jsxDEV(S.AddTagWrapper, {\n        children: [/*#__PURE__*/_jsxDEV(S.PlusIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(S.AddTagText, {\n          children: t('newsFeed.tag')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, _this), !!selectedTags.length && /*#__PURE__*/_jsxDEV(S.TagsWrapper, {\n      children: selectedTags.map(function (tag) {\n        return /*#__PURE__*/_jsxDEV(Tag, {\n          title: tag.title,\n          bgColor: tag.bgColor,\n          removeTag: function removeTag() {\n            return onTagClick(tag);\n          }\n        }, tag.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }, _this), /*#__PURE__*/_jsxDEV(S.DateLabels, {\n      children: [/*#__PURE__*/_jsxDEV(S.DateLabel, {\n        children: t('newsFeed.from')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(S.DateLabel, {\n        children: t('newsFeed.to')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.RangePicker, {\n      dropdownClassName: \"range-picker\",\n      value: dates,\n      onChange: function onChange(dates) {\n        return updateFilteredField('dates', [dates !== null && dates !== void 0 && dates.length ? dates[0] : null, dates !== null && dates !== void 0 && dates.length ? dates[1] : null]);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.BtnWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(S.Btn, {\n        onClick: function onClick() {\n          return resetFilter();\n        },\n        children: t('newsFeed.reset')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(S.Btn, {\n        onClick: function onClick() {\n          return applyFilter();\n        },\n        type: \"primary\",\n        children: t('newsFeed.apply')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Filter, \"UcyvVDUGV+5gWYNQY+uUK18V3vQ=\", false, function () {\n  return [useTranslation, useResponsive];\n});\n\n_c = Filter;\nexport var NewsFilter = function NewsFilter(_ref2) {\n  _s2();\n\n  var news = _ref2.news,\n      newsTags = _ref2.newsTags,\n      children = _ref2.children;\n\n  var _useState = useState({\n    author: '',\n    title: '',\n    selectedTags: [],\n    dates: [null, null]\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      filterFields = _useState2[0],\n      setFilterFields = _useState2[1];\n\n  var author = filterFields.author,\n      title = filterFields.title,\n      selectedTags = filterFields.selectedTags,\n      dates = filterFields.dates;\n\n  var _useState3 = useState(news),\n      _useState4 = _slicedToArray(_useState3, 2),\n      filteredNews = _useState4[0],\n      setFilteredNews = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      overlayVisible = _useState6[0],\n      setOverlayVisible = _useState6[1];\n\n  var _useResponsive2 = useResponsive(),\n      mobileOnly = _useResponsive2.mobileOnly;\n\n  var _useTranslation2 = useTranslation(),\n      t = _useTranslation2.t;\n\n  var newsTagData = Object.values(newsTags || defaultTags);\n  var selectedTagsIds = useMemo(function () {\n    return selectedTags.map(function (item) {\n      return item.id;\n    });\n  }, [selectedTags]);\n  var onTagClick = useCallback(function (tag) {\n    var isExist = selectedTagsIds.includes(tag.id);\n\n    if (isExist) {\n      setFilterFields(_objectSpread(_objectSpread({}, filterFields), {}, {\n        selectedTags: selectedTags.filter(function (item) {\n          return item.id !== tag.id;\n        })\n      }));\n    } else {\n      setFilterFields(_objectSpread(_objectSpread({}, filterFields), {}, {\n        selectedTags: [].concat(_toConsumableArray(selectedTags), [tag])\n      }));\n    }\n  }, [selectedTags, selectedTagsIds, filterFields]);\n  var filterNews = useCallback(function () {\n    var isReset = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    var updatedNews = _toConsumableArray(news);\n\n    if ((author || title || dates[0] || selectedTags.length) && !isReset) {\n      updatedNews = news.filter(function (post) {\n        var postAuthor = post.author.toLowerCase();\n        var enteredAuthor = author.toLowerCase();\n        var postTitle = post.title.toLowerCase();\n        var enteredTitle = title.toLowerCase();\n        var postTags = post.tags;\n        var postDate = Dates.getDate(post.date);\n        var fieldsValidators = [new AuthorValidator(postAuthor, enteredAuthor), new TitleValidator(postTitle, enteredTitle), new DatesValidator(postDate, dates), new TagsValidator(postTags, selectedTags)];\n        return fieldsValidators.map(function (validator) {\n          return validator.validate();\n        }).every(function (i) {\n          return i;\n        });\n      });\n    }\n\n    setFilteredNews(updatedNews.sort(function (a, b) {\n      return b.date - a.date;\n    }));\n  }, [news, author, title, dates, selectedTags]);\n  useEffect(function () {\n    setFilteredNews(news);\n    filterNews(false); // TODO AT-183\n    // eslint-disable-next-line\n  }, [news]);\n  var handleClickApply = useCallback(function () {\n    filterNews(false);\n\n    if (mobileOnly) {\n      setOverlayVisible(false);\n    }\n  }, [mobileOnly, filterNews]);\n  var handleClickReset = useCallback(function () {\n    setFilterFields({\n      author: '',\n      title: '',\n      dates: [null, null],\n      selectedTags: []\n    });\n    filterNews(true);\n\n    if (mobileOnly) {\n      setOverlayVisible(false);\n    }\n  }, [filterNews, setFilterFields, mobileOnly]);\n\n  var updateFilteredField = function updateFilteredField(field, value) {\n    setFilterFields(_objectSpread(_objectSpread({}, filterFields), {}, _defineProperty({}, field, value)));\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(S.TitleWrapper, {\n      children: mobileOnly && /*#__PURE__*/_jsxDEV(Dropdown, {\n        placement: \"bottomLeft\",\n        trigger: ['click'],\n        visible: overlayVisible,\n        onVisibleChange: function onVisibleChange(visible) {\n          return setOverlayVisible(visible);\n        },\n        overlay: /*#__PURE__*/_jsxDEV(Filter, {\n          author: author,\n          title: title,\n          newsTagData: newsTagData,\n          onTagClick: onTagClick,\n          selectedTagsIds: selectedTagsIds,\n          selectedTags: selectedTags,\n          dates: dates,\n          onApply: handleClickApply,\n          onReset: handleClickReset,\n          updateFilteredField: updateFilteredField\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 15\n        }, _this),\n        children: /*#__PURE__*/_jsxDEV(S.FilterButton, {\n          children: t('newsFeed.filter')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.ContentWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(S.NewsWrapper, {\n        children: children({\n          filteredNews: filteredNews || news\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, _this), !mobileOnly && /*#__PURE__*/_jsxDEV(Filter, {\n        author: author,\n        title: title,\n        newsTagData: newsTagData,\n        onTagClick: onTagClick,\n        selectedTagsIds: selectedTagsIds,\n        selectedTags: selectedTags,\n        dates: dates,\n        onApply: handleClickApply,\n        onReset: handleClickReset,\n        updateFilteredField: updateFilteredField\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n};\n\n_s2(NewsFilter, \"MJnkGXRht/tcWEEfATlFax6FoNU=\", false, function () {\n  return [useResponsive, useTranslation];\n});\n\n_c2 = NewsFilter;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Filter\");\n$RefreshReg$(_c2, \"NewsFilter\");","map":{"version":3,"sources":["/workspace/lightence-ant-design-react-template/src/components/apps/newsFeed/NewsFilter/NewsFilter.tsx"],"names":["React","useState","useEffect","useCallback","useMemo","useTranslation","Tag","AuthorValidator","TitleValidator","DatesValidator","TagsValidator","useResponsive","newsTags","defaultTags","Dates","S","Dropdown","Filter","author","title","newsTagData","onTagClick","selectedTagsIds","selectedTags","dates","onApply","onReset","updateFilteredField","t","mobileOnly","applyFilter","resetFilter","event","target","value","map","tag","e","stopPropagation","includes","id","bgColor","length","NewsFilter","news","children","filterFields","setFilterFields","filteredNews","setFilteredNews","overlayVisible","setOverlayVisible","Object","values","item","isExist","filter","filterNews","isReset","updatedNews","post","postAuthor","toLowerCase","enteredAuthor","postTitle","enteredTitle","postTags","tags","postDate","getDate","date","fieldsValidators","validator","validate","every","i","sort","a","b","handleClickApply","handleClickReset","field","visible"],"mappings":"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","sourcesContent":["import React, { ReactNode, useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { RangeValue } from 'rc-picker/lib/interface.d';\nimport { Tag, ITag } from '@app/components/common/Tag/Tag';\nimport { AuthorValidator, TitleValidator, DatesValidator, TagsValidator } from '../Validator';\nimport { useResponsive } from '@app/hooks/useResponsive';\nimport { newsTags as defaultTags } from '@app/constants/newsTags';\nimport { AppDate, Dates } from '@app/constants/Dates';\nimport { Post } from '@app/api/news.api';\nimport * as S from './NewsFilter.styles';\nimport { Dropdown } from '@app/components/common/Dropdown/Dropdown';\n\ninterface NewsFilterProps {\n  news: Post[];\n  newsTags?: ITag[];\n  children: ({ filteredNews }: { filteredNews: Post[] }) => ReactNode;\n}\n\ninterface Filter {\n  author: string;\n  title: string;\n  newsTagData: ITag[];\n  onTagClick: (tag: ITag) => void;\n  selectedTagsIds: Array<string>;\n  selectedTags: ITag[];\n  dates: [AppDate | null, AppDate | null];\n  updateFilteredField: (field: string, value: [AppDate | null, AppDate | null] | string) => void;\n  onApply: () => void;\n  onReset: () => void;\n}\n\nconst Filter: React.FC<Filter> = ({\n  author,\n  title,\n  newsTagData,\n  onTagClick,\n  selectedTagsIds,\n  selectedTags,\n  dates,\n  onApply,\n  onReset,\n  updateFilteredField,\n}) => {\n  const { t } = useTranslation();\n  const { mobileOnly } = useResponsive();\n\n  const applyFilter = () => {\n    onApply();\n  };\n\n  const resetFilter = () => {\n    onReset();\n  };\n\n  return (\n    <S.FilterWrapper>\n      {!mobileOnly && <S.FilterTitle>{t('newsFeed.filter')}</S.FilterTitle>}\n\n      <S.InputWrapper>\n        <S.SearchIcon />\n        <S.Input\n          placeholder={t('newsFeed.authorSearch')}\n          value={author}\n          onChange={(event) => updateFilteredField('author', event.target.value)}\n        />\n      </S.InputWrapper>\n\n      <S.InputWrapper>\n        <S.SearchIcon />\n        <S.Input\n          placeholder={t('newsFeed.titleSearch')}\n          value={title}\n          onChange={(event) => updateFilteredField('title', event.target.value)}\n        />\n      </S.InputWrapper>\n\n      <Dropdown\n        placement=\"bottomCenter\"\n        trigger={['click']}\n        overlay={\n          <S.TagPopover>\n            {newsTagData.map((tag: ITag) => (\n              <S.TagPopoverLine\n                key={tag.id}\n                onClick={(e) => {\n                  onTagClick(tag);\n                  e.stopPropagation();\n                }}\n              >\n                <S.PopoverCheckbox checked={selectedTagsIds.includes(tag.id)} />\n                <Tag title={tag.title} bgColor={tag.bgColor} />\n              </S.TagPopoverLine>\n            ))}\n            <S.ClosePopoverWrapper>\n              <S.ClosePopover />\n            </S.ClosePopoverWrapper>\n          </S.TagPopover>\n        }\n      >\n        <S.AddTagWrapper>\n          <S.PlusIcon />\n          <S.AddTagText>{t('newsFeed.tag')}</S.AddTagText>\n        </S.AddTagWrapper>\n      </Dropdown>\n\n      {!!selectedTags.length && (\n        <S.TagsWrapper>\n          {selectedTags.map((tag) => (\n            <Tag key={tag.id} title={tag.title} bgColor={tag.bgColor} removeTag={() => onTagClick(tag)} />\n          ))}\n        </S.TagsWrapper>\n      )}\n\n      <S.DateLabels>\n        <S.DateLabel>{t('newsFeed.from')}</S.DateLabel>\n        <S.DateLabel>{t('newsFeed.to')}</S.DateLabel>\n      </S.DateLabels>\n\n      <S.RangePicker\n        dropdownClassName=\"range-picker\"\n        value={dates}\n        onChange={(dates: RangeValue<AppDate>) =>\n          updateFilteredField('dates', [dates?.length ? dates[0] : null, dates?.length ? dates[1] : null])\n        }\n      />\n\n      <S.BtnWrapper>\n        <S.Btn onClick={() => resetFilter()}>{t('newsFeed.reset')}</S.Btn>\n        <S.Btn onClick={() => applyFilter()} type=\"primary\">\n          {t('newsFeed.apply')}\n        </S.Btn>\n      </S.BtnWrapper>\n    </S.FilterWrapper>\n  );\n};\n\nexport const NewsFilter: React.FC<NewsFilterProps> = ({ news, newsTags, children }) => {\n  const [filterFields, setFilterFields] = useState<{\n    author: string;\n    title: string;\n    selectedTags: ITag[];\n    dates: [AppDate | null, AppDate | null];\n  }>({\n    author: '',\n    title: '',\n    selectedTags: [],\n    dates: [null, null],\n  });\n  const { author, title, selectedTags, dates } = filterFields;\n  const [filteredNews, setFilteredNews] = useState<Post[]>(news);\n  const [overlayVisible, setOverlayVisible] = useState<boolean>(false);\n  const { mobileOnly } = useResponsive();\n  const { t } = useTranslation();\n\n  const newsTagData = Object.values(newsTags || defaultTags);\n  const selectedTagsIds = useMemo(() => selectedTags.map((item) => item.id), [selectedTags]);\n\n  const onTagClick = useCallback(\n    (tag: ITag) => {\n      const isExist = selectedTagsIds.includes(tag.id);\n\n      if (isExist) {\n        setFilterFields({\n          ...filterFields,\n          selectedTags: selectedTags.filter((item) => item.id !== tag.id),\n        });\n      } else {\n        setFilterFields({\n          ...filterFields,\n          selectedTags: [...selectedTags, tag],\n        });\n      }\n    },\n    [selectedTags, selectedTagsIds, filterFields],\n  );\n\n  const filterNews = useCallback(\n    (isReset = false) => {\n      let updatedNews = [...news];\n      if ((author || title || dates[0] || selectedTags.length) && !isReset) {\n        updatedNews = news.filter((post) => {\n          const postAuthor = post.author.toLowerCase();\n          const enteredAuthor = author.toLowerCase();\n          const postTitle = post.title.toLowerCase();\n          const enteredTitle = title.toLowerCase();\n          const postTags = post.tags;\n          const postDate = Dates.getDate(post.date);\n\n          const fieldsValidators = [\n            new AuthorValidator(postAuthor, enteredAuthor),\n            new TitleValidator(postTitle, enteredTitle),\n            new DatesValidator(postDate, dates),\n            new TagsValidator(postTags, selectedTags),\n          ];\n\n          return fieldsValidators.map((validator) => validator.validate()).every((i) => i);\n        });\n      }\n      setFilteredNews(\n        updatedNews.sort((a, b) => {\n          return b.date - a.date;\n        }),\n      );\n    },\n    [news, author, title, dates, selectedTags],\n  );\n\n  useEffect(() => {\n    setFilteredNews(news);\n    filterNews(false);\n    // TODO AT-183\n    // eslint-disable-next-line\n  }, [news]);\n\n  const handleClickApply = useCallback(() => {\n    filterNews(false);\n\n    if (mobileOnly) {\n      setOverlayVisible(false);\n    }\n  }, [mobileOnly, filterNews]);\n\n  const handleClickReset = useCallback(() => {\n    setFilterFields({ author: '', title: '', dates: [null, null], selectedTags: [] });\n    filterNews(true);\n\n    if (mobileOnly) {\n      setOverlayVisible(false);\n    }\n  }, [filterNews, setFilterFields, mobileOnly]);\n\n  const updateFilteredField = (field: string, value: string | [AppDate | null, AppDate | null]) => {\n    setFilterFields({ ...filterFields, [field]: value });\n  };\n\n  return (\n    <>\n      <S.TitleWrapper>\n        {mobileOnly && (\n          <Dropdown\n            placement=\"bottomLeft\"\n            trigger={['click']}\n            visible={overlayVisible}\n            onVisibleChange={(visible) => setOverlayVisible(visible)}\n            overlay={\n              <Filter\n                author={author}\n                title={title}\n                newsTagData={newsTagData}\n                onTagClick={onTagClick}\n                selectedTagsIds={selectedTagsIds}\n                selectedTags={selectedTags}\n                dates={dates}\n                onApply={handleClickApply}\n                onReset={handleClickReset}\n                updateFilteredField={updateFilteredField}\n              />\n            }\n          >\n            <S.FilterButton>{t('newsFeed.filter')}</S.FilterButton>\n          </Dropdown>\n        )}\n      </S.TitleWrapper>\n\n      <S.ContentWrapper>\n        <S.NewsWrapper>{children({ filteredNews: filteredNews || news })}</S.NewsWrapper>\n\n        {!mobileOnly && (\n          <Filter\n            author={author}\n            title={title}\n            newsTagData={newsTagData}\n            onTagClick={onTagClick}\n            selectedTagsIds={selectedTagsIds}\n            selectedTags={selectedTags}\n            dates={dates}\n            onApply={handleClickApply}\n            onReset={handleClickReset}\n            updateFilteredField={updateFilteredField}\n          />\n        )}\n      </S.ContentWrapper>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}